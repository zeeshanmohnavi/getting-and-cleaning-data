# Create Tidy Data

This repository contains artefacts for the final project for the course "Getting and Cleaning Data" on Coursera offered by John Hopkins University.  

The task for this assignment is to clean a given raw database collected from the accelerometers from a Samsung Galaxy S smartphone. A complete description of the data can be found at the [UCI Machine Learning Repository Archive](http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones).  

The goal this project is to generate a **tidy** data set from a collection of text data files. The general principles of tidy data are laid out by [Hadley Wickham](http://had.co.nz/) in [this paper](https://vita.had.co.nz/papers/tidy-data.pdf) and [this video](http://vimeo.com/33727555).  

- Each variable is a column,
- Each observation is a row, and
- Each type of observational unit is a table
  
## Getting Started

These instructions will let you setup a working environment for running the scripts in this project for development and testing purposes.  

### Prerequisites

The project is built on a system with the following configuration.  

1. Windows 7 x64
2. `R` version 4.0.0
3. The following `R` packages are required.
   * `stringr` version 1.4.0
   * `readr` version 1.3.1
   * `dplyr` version 1.0.0
   
   
### Installation

Before proceeding with running the scripts in this project, run the below commands in `R` to install the required libraries.  

```r
install.packages("stringr")
install.packages("readr")
install.packages("dplyr")
```  

### Working Directory Organization

The working directory is organized as follows. It is to note that the file `tidy.txt` is the output file, and it is generated by the `run_analysis.R` script. It is not present in the `/output/` directory now, but is shown only for completeness.  

```
   ~
   |--- getting-and-cleaning-data
        |--- data
             |--- UCI HAR Dataset
                  |--- activity_labels.txt
                  |--- features.txt
                  |--- features_info.txt
                  |--- README.txt
                  |--- test
                  |--- train
        |--- images
        |--- output
             |--- tidy.txt
        |--- scripts
             |--- _utility_create_header.R
             |--- _utility_extract_zip.R
             |--- run_analysis.R
```  

### Scripts

1. `_utility_extract_zip.R`  
    This is a helper script to extract a ZIP archive into a user-provided target directory.  
    Usage: To extract the data for the project available on [Coursera](https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip) into the `getting-and-cleaning-data/data` directory.

2. `_utility_create_header.R`  
    This is also a helper script to create descriptive headers for the data frame created from the data files.  
    Usage: In the `run_analysis.R` script

3. `run_analysis.R`  
    This is the main script which reads and processes the data files to create the required tidy data set. 
  
  
#### Analysis Steps

This project has **5 requirements** that are required to be completed.  

1. Merge the training and the test sets to create one data set
2. Extract only the measurements on the mean and standard deviation for each observation
3. Use descriptive activity names to name the activities in the data set
4. Appropriately label the data set with descriptive names
5. From the data set obtained after step `4`, create another, independent **tidy** data set with the average of each variable for each activity and each subject  
   
  
To obtain the tidy data set, the `run_analysis.R` script take the following actions.  

- Read the list of features from `data/UCI HAR Dataset/features.txt` into  list.  
  There are **561 features** present in each observation.
- Read the list of activities for which observations were captured from the file `data/UCI HAR Dataset/activity_labels.txt`.  
  There are **6 activity types** used in the data collection process. They are listed in the format `<activity_id, activity_name>`:
  
  <a name=activity></a>
  
  ```
     1 WALKING
     2 WALKING_UPSTAIRS
     3 WALKING_DOWNSTAIRS
     4 SITTING
     5 STANDING
     6 LAYING
  ```

- Read the files `X_test.txt`, `y_test.txt`, and `subject_test.txt` from the directory `data/UCI HAR Dataset/test` to create the data frame representing the test data. Stote it in the object `test_data`.  
     
  Each observation in `test_data` contains the `subject`, `activity`, along with the 561 features.
     
  ![](./images/test_data.png)
     
- Similarly, read the files `X_train.txt`, `y_train.txt`, and `subject_train.txt` from the directory `data/UCI HAR Dataset/train` to create the data frame representing the training data. Stote it in the object `train_data`.  
     
  Each observation in `train_data` contains the `subject`, `activity`, along with the 561 features.
     
  ![](./images/train_data.png)
     
- The training and testing data are now merged to create a data frame containing all the observations.  
  *This satisfies __requirement 1__ of the project*.
     
  ![](./images/merged_raw.png)
     
- To obtain the headers which only relates to mean and standard deviation values, ***regular expressions*** are used. The data set containing only these column values are stored in the object `merged_data`.  
*This satisfies __requirement 2__ of the project*.
     
- As of now, `merged_data` has a column named `activity` which captures the [*activity id*](#activity) the observation corresponds to. The *activity id's* are replaced with the corresponding *activity name's* in the data frame.  
  *This satisfies __requirement 3__ of the project*.
     
- The headers in our data frame `merged_data` uses abbreviations. Some examples of the existing header values are given below.
     
  ```
     tBodyAcc-std()-Z
     tGravityAcc-mean()-Z
     fBodyBodyGyroMag-mean()
     fBodyAccJerk-std()-X
  ```
  The goal in this step is to rename the headers to contain self-explanatory, descriptive names. The helper script `_utility_create_header.R` is used to achieve this. Some examples of the new header names are given below.  
          
  ```
     time_body_accelerometer_sd_Z_axis
     time_gravity_accelerometer_mean_Z_axis
     freq_body_gyrometer_magnitude_mean
     freq_body_accelerometer_jerk_sd_X_axis
  ```
     
  The following table explains the naming convention followed for generating the new headers.
     
  <a name=token-desc></a>
     
  | **Token** | **Description** |
  |-----------|-----------------|
  | time | These are time domain signals |
  | freq | These are frequency domain signals |
  | body | Indicates body acceleration signals |
  | gravity | Indicates gravity acceleration signals |
  | accelerometer | These signals are captured using the accelerometer |
  | gyrometer | These signals are captured using the gyrometer |
  | jerk | Captures the linear acceleration (when used with `accelerometer`) and angular velocity (when used with `gyrometer`) of the body |
  | magnitude | Magnitude value of all the three-dimensional signals calculated using the Euclidean norm |
  | mean | Indicates mean value |
  | sd | Indicates standard deviation values |
  | X_axis | The values were captured along the X-axis |
  | Y_axis | The values were captured along the Y-axis |
  | Z_axis | The values were captured along the Z-axis |
     
     
  For example, the header `time_body_accelerometer_sd_Z_axis` indicates that the value is *the standard deviation of an acceleration signal of a body captured using an accelerometer along the Z-axis in time-domain*. 
  *This satisfies __requirement 4__ of the project*.
     
- The final task of the project is to create a tidy data set where each variable (in the tidy data) is an average of the corresponding variable in the previous data set. The tidy data is grouped according to **activity** and **subject**. The tidy data is then written to a file `tidy.txt` in the `/output` directory.
  *This satisfies __requirement 5__ of the project*.
     
- The tidy data set can be loaded and viewd into the `R` environment using the following command.
       
  ```r
     tidy_loaded <- read.table("./output/tidy.txt", header = TRUE, sep = " ")
     View(tidy_loaded)
  ```
       
## Author

- **Md. Zeeshan Mohnavi**  
  GitHUb - [zeeshanmohnavi](https://github.com/zeeshanmohnavi)  
  Email - <zeeshanmohnavi@gmail.com>
  
